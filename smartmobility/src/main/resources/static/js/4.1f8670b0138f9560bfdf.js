webpackJsonp([4],{"4elA":function(e,t){},PNBq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("woOf"),o=i.n(n),r=i("Dd8w"),a=i.n(r),c=i("NYxO"),s={components:{Buttons:i("SDIm").a},data:function(){return{pickerOptions:{shortcuts:[{text:"Today",onClick:function(e){e.$emit("pick",new Date)}},{text:"Tomorrow",onClick:function(e){var t=new Date;t.setTime(t.getTime()+864e5),e.$emit("pick",t)}},{text:"A week ago",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},buttonEvents:{refresh:{show:!0,event:this.loadGrid},delete:{show:!0,event:this.cancelReserve}},scenarioForm:{scenarioName:"",userCount:1,loopCount:1},unRegisterAction:[],registerAction:[],rules:{scenarioName:[{required:!0,message:"시나리오명을 입력해주세요",trigger:"blur"}],userCount:[{required:!0,message:"유저수를 입력해주세요",trigger:"blur"}],loopCount:[{required:!0,message:"반복횟수를 입력해주세요",trigger:"blur"}],reserveTime:[{required:!0,message:"예약날짜를 입력해주세요",trigger:"blur"}]},reserveTime:"",data:[],deletedScenarioData:[],allChecked:!1,rowClicked:!1,isUpdate:!0,loading:!1,focusIndex:0,dialogDeletedScenario:!1,deletedLoading:!1}},mounted:function(){this.loadGrid()},computed:{checkedRows:function(){return this.data.filter(function(e){return e.selected})}},methods:a()({},Object(c.c)(["setIsExecute"]),{cancelReserve:function(){var e=this;this.axios.post("/api/v1/action/check").then(function(t){1==t.data.executeFlag?e.notification("actionIsRun"):0==e.checkedRows.length?e.notification("deleteReserveCheck"):e.$confirm("체크한 예약시나리오들을 삭제하시겠습니까? (삭제된 예약은 실행되지 않습니다.)",{confirmButtonText:"삭제",cancelButtonText:"취소",type:"warning"}).then(function(){var t=[];e.checkedRows.forEach(function(e){return t.push(e.reserveId)}),e.axios.delete("/api/v1/scenario/reserve",{data:{reserveIds:t}}).then(function(t){t.data&&(e.loadGrid(!0),e.notification("deleteReserve"))}).catch(function(t){e.notification("deleteReserveError")})})})},timer:function(){setTimeout(frontReserve,1e3)},loadGrid:function(e){var t=this;this.loading=!0,this.axios.get("/api/v1/scenario/reserve").then(function(i){var n;(t.loading=!1,i.data.reserveList.forEach(function(e,t){e.index=t}),t.data=i.data.reserveList,t.unRegisterAction=i.data.actionList,0==t.data.length)?(t.isUpdate=!1,t.allChecked=!1,t.resetScenarioForm()):(n=e?t.data.length-1:t.focusIndex,t.$refs.scenarioList.selectRow(t.data[n]))}).catch(function(e){t.loading=!1,console.log(e)})},loadDeletedGrid:function(){var e=this;this.axios.get("/api/v1/scenario/deleted").then(function(t){e.deletedScenarioData=t.data.deletedScenarioList,e.dialogDeletedScenario=!0}).catch(function(e){console.log(e)})},onAllCheckedChange:function(e){this.rowClicked||(this.data=this.data.map(function(t){return o()({},t,{selected:e})}))},onCheckedChange:function(e){var t=this;this.allChecked=this.checkedRows.length===this.data.length,this.rowClicked=!0,this.$nextTick(function(){return t.rowClicked=!1})},resetScenarioForm:function(){this.$refs.scenarioForm.resetFields(),this.registerAction=[]},scenarioClick:function(e){if(this.isUpdate=!0,e){this.focusIndex=e.index;var t=o()({},e);this.scenarioForm=t;for(var i=[],n=0;n<e.actionList.length;n++)i.push(e.actionList[n].actionId);this.registerAction=i}},saveScenario:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;if(0==t.registerAction.length)return t.notification("saveScenarioCheck"),!1;var i={scenario:{scenarioName:t.scenarioForm.scenarioName,loopCount:t.scenarioForm.loopCount,userCount:t.scenarioForm.userCount,reserveTime:t.scenarioForm.reserveTime,scenarioList:t.checkedRows},actionIds:t.registerAction};0==t.checkedRows.length?t.notification("executeScenarioCheck"):t.isUpdate?(i.scenario.scenarioId=t.scenarioForm.scenarioId,t.axios.post("/api/v1/scenario/reserve",i).then(function(e){t.loadGrid(),t.notification("saveScenario")})):t.axios.post("/api/v1/scenario/reserve",i).then(function(e){t.loadGrid(!0),t.notification("saveScenario")})})},addScenario:function(){var e=this;this.resetScenarioForm(),this.$refs.scenarioList.clearSelections(),this.$nextTick(function(){return e.isUpdate=!1})},deleteScenario:function(){var e=this;0==this.checkedRows.length?this.notification("deleteScenarioCheck"):this.$confirm("체크한 시나리오들을 삭제하시겠습니까?",{confirmButtonText:"삭제",cancelButtonText:"취소",type:"warning"}).then(function(){var t=[];e.checkedRows.forEach(function(e){return t.push(e.scenarioId)}),e.axios.delete("/api/v1/scenario",{data:{scenarioIds:t}}).then(function(t){t.data&&(e.loadGrid(!0),e.notification("deleteScenario"))}).catch(function(t){e.notification("deleteScenarioError")})})},executeScenario:function(){0==this.checkedRows.length?this.notification("executeScenarioCheck"):(this.setIsExecute({isExecute:!0,message:"시나리오가 실행중입니다"}),this.axios.post("/api/v1/scenario/execute",{scenarioList:this.checkedRows}).then(function(e){}))},pauseScenario:function(){var e=this;this.axios.post("/api/v1/scenario/pause").then(function(t){e.setIsExecute({isExecute:!1})}).catch(function(t){e.setIsExecute({isExecute:!1}),console.log(t)})},showDeletedScenario:function(){this.loadDeletedGrid()},recoveryScenario:function(e){var t=this;this.$confirm("시나리오를 복원하시겠습니까?","시나리오복원",{confirmButtonText:"복원",cancelButtonText:"취소",type:"info"}).then(function(){t.axios.post("/api/v1/scenario/recovery",{scenarioIds:[e.scenarioId]}).then(function(e){t.loadGrid(),t.loadDeletedGrid()}).catch(function(){})})}})},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Layout",{staticStyle:{width:"100%"}},[i("LayoutPanel",{staticStyle:{height:"45px","text-align":"right"},attrs:{region:"north",border:!1}},[i("Buttons",{attrs:{buttonEvents:e.buttonEvents}})],1),e._v(" "),i("LayoutPanel",{staticStyle:{width:"450px"},attrs:{region:"west",title:"시나리오 목록"}},[i("template",{slot:"header"},[i("div",{staticClass:"f-row"},[i("div",{staticClass:"panel-title f-full"},[e._v("예약 시나리오 목록")])])]),e._v(" "),i("DataGrid",{ref:"scenarioList",staticStyle:{width:"100%",height:"100%"},attrs:{data:e.data,columnResizing:!0,border:!1,loading:e.loading,selectionMode:"single"},on:{selectionChange:function(t){return e.scenarioClick(t)}}},[i("GridColumn",{attrs:{field:"ck",width:"30",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("CheckBox",{on:{checkedChange:function(t){return e.onAllCheckedChange(t)}},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}})]}},{key:"body",fn:function(t){return[i("CheckBox",{on:{checkedChange:function(t){return e.onCheckedChange(t)}},model:{value:t.row.selected,callback:function(i){e.$set(t.row,"selected",i)},expression:"scope.row.selected"}})]}}])}),e._v(" "),i("GridColumn",{attrs:{cellCss:"datagrid-td-rownumber",width:"50",align:"center"},scopedSlots:e._u([{key:"body",fn:function(t){return[e._v("\n                        "+e._s(t.rowIndex+1)+"\n                    ")]}}])},[i("template",{slot:"header"},[e._v("\n                        No.\n                    ")])],2),e._v(" "),i("GridColumn",{attrs:{field:"scenarioName",title:"시나리오명",halign:"60"}}),e._v(" "),i("GridColumn",{attrs:{field:"reserveTime",title:"예약 날짜",width:"center",align:"center"}}),e._v(" "),i("GridColumn",{attrs:{field:"status",title:"실행 유무",width:"60",align:"center"}})],1)],2),e._v(" "),i("LayoutPanel",{staticStyle:{width:"100%",height:"100%"},attrs:{region:"center",title:"시나리오 내용"}},[i("el-form",{ref:"scenarioForm",attrs:{model:e.scenarioForm,rules:e.rules,"label-position":"left","label-width":"100px",size:"mini"}},[i("el-form-item",{attrs:{label:"시나리오명",prop:"scenarioName"}},[i("el-input",{attrs:{placeholder:"예약모듈 시나리오",disabled:!0},model:{value:e.scenarioForm.scenarioName,callback:function(t){e.$set(e.scenarioForm,"scenarioName",t)},expression:"scenarioForm.scenarioName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"예약날짜",prop:"reserveTime"}},[i("el-input",{attrs:{placeholder:"20201212_14:30",disabled:!0},model:{value:e.scenarioForm.reserveTime,callback:function(t){e.$set(e.scenarioForm,"reserveTime",t)},expression:"scenarioForm.reserveTime"}})],1)],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"삭제된 시나리오 목록",visible:e.dialogDeletedScenario,width:"800px"},on:{"update:visible":function(t){e.dialogDeletedScenario=t}}},[0==e.deletedScenarioData.length?i("span",[e._v("삭제된 시나리오가 없습니다")]):e._e(),e._v(" "),0!=e.deletedScenarioData.length?i("DataGrid",{staticStyle:{height:"400px"},attrs:{data:e.deletedScenarioData,loading:e.deletedLoading}},[i("GridColumn",{attrs:{align:"center",cellCss:"datagrid-td-rownumber",width:"30"},scopedSlots:e._u([{key:"body",fn:function(t){return[e._v("\n                    "+e._s(t.rowIndex+1)+"\n                ")]}}],null,!1,3393989708)},[i("template",{slot:"header"},[e._v("\n                    No.\n                ")])],2),e._v(" "),i("GridColumn",{attrs:{field:"scenarioName",title:"시나리오명",halign:"center"}}),e._v(" "),i("GridColumn",{attrs:{field:"loopCount",title:"반복 횟수",align:"center"}}),e._v(" "),i("GridColumn",{attrs:{field:"registerActionCount",title:"등록된 동작 개수",align:"center"}}),e._v(" "),i("GridColumn",{attrs:{field:"delDt",title:"삭제일시",align:"center"}}),e._v(" "),i("GridColumn",{attrs:{title:"",width:"50",align:"center"},scopedSlots:e._u([{key:"body",fn:function(t){return[i("LinkButton",{on:{click:function(i){return e.recoveryScenario(t.row)}}},[e._v("복원")])]}}],null,!1,3501991017)})],1):e._e()],1)],1)},staticRenderFns:[]};var d=i("VU/8")(s,l,!1,function(e){i("yy6f"),i("4elA")},"data-v-112bec08",null);t.default=d.exports},yy6f:function(e,t){}});
//# sourceMappingURL=4.1f8670b0138f9560bfdf.js.map